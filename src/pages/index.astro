---
import Header from '../components/Header.astro';
import IconsContainer from '../components/IconsContainer.astro';
import { Copy, SearchNormal } from 'iconsax-astro';
import Layout from '../layouts/Layout.astro';
---

<Layout>
  <div class="flex flex-col gap-1 mt-24">
    <h1 class="font-bold text-white text-4xl sm:text-5xl">Iconsax Astro</h1>
    <h2 class="text-white text-xl sm:text-2xl">Vuesax's icon library. Now for Astro!</h2>
    <div class="flex mt-5 gap-5">
      <a
        href="https://github.com/matt-pasek/iconsax-astro"
        class="hover:animate-none relative inline-flex p-[1px] overflow-hidden rounded-md focus:outline-none focus:ring-1 focus:ring-slate-400 focus:ring-offset-2 focus:ring-offset-slate-50"
      >
        <span
          id="gradient-spinner"
          class="absolute inset-[-1000%] animate-[spin_2s_linear_infinite] bg-[conic-gradient(from_90deg_at_50%_50%,#141301_0%,#F2E9DC_80%,#141301_100%)]"
        ></span>
        <span
          class="inline-flex px-5 py-2 cursor-pointer items-center justify-center rounded-md bg-black text-white backdrop-blur-3xl hover:font-medium transition-all"
        >
          Getting Started
        </span>
      </a>
      <button
        id="copy-button"
        class="flex gap-2 text-white px-5 py-2 bg-accent-30 rounded-md hover:bg-accent-40 transition-all duration-200 ease-in-out"
      >
        > npm i iconsax-astro
        <Copy type="bulk" color="white" />
      </button>
    </div>
  </div>
  <div class="mt-20 flex justify-between">
    <div class="px-2 py-2 flex items-center gap-2 bg-accent-30 rounded-md">
      <SearchNormal color="white" type="bulk" />
      <input
        id="search"
        placeholder="Search icons"
        class="bg-transparent font-inter text-white/80 focus:outline-none placeholder:font-light placeholder:text-white/30"
      />
    </div>
    <div id="picker"></div>
  </div>
  <IconsContainer />
  <script>
    /* copy button */
    const copyButton = document.getElementById('copy-button');
    function copyToClipboard() {
      const copyButtonContent = copyButton.innerHTML;
      navigator.clipboard.writeText('npm i iconsax-astro');
      copyButton.textContent = 'Copied!';
      setTimeout(() => {
        copyButton.innerHTML = copyButtonContent;
      }, 2000);
    }

    copyButton.addEventListener('click', () => {
      copyToClipboard();
    });

    /* search */
    const search = document.getElementById('search') as HTMLInputElement;

    function searchIcons() {
      const iconsContainer = document.querySelector('#icons-container');
      const inputString = search.value;
      const icons = document.querySelectorAll('[id^="astro-"]');

      if (iconsContainer) iconsContainer.scrollTo(0, 0);

      if (!inputString) {
        // If the input is empty, show all icons
        icons.forEach((icon) => {
          icon.classList.remove('hidden');
        });
        return;
      }

      icons.forEach((icon) => {
        const iconName = icon.id.replace('astro-', '');
        if (iconName.includes(inputString)) {
          icon.classList.remove('hidden');
        } else {
          icon.classList.add('hidden');
        }
      });

      const hiddenIcons = document.querySelectorAll('[id^="astro-"].hidden');

      if (icons.length - hiddenIcons.length < 5) {
        iconsContainer.classList.add('!justify-start');
      } else {
        iconsContainer.classList.remove('!justify-start');
      }

      if (hiddenIcons.length === icons.length) {
        // check if noResults already exists
        if (document.querySelector('#no-results')) return;
        const noResults = document.createElement('p');
        noResults.id = 'no-results';
        noResults.classList.add('text-white', 'text-xl', 'mt-10');
        noResults.textContent = 'No results found';
        document.querySelector('main').appendChild(noResults);
      } else {
        const noResults = document.querySelector('#no-results');
        if (noResults) {
          noResults.remove();
        }
      }
    }

    search.addEventListener('input', () => {
      searchIcons();
    });
  </script>
</Layout>
